{"ast":null,"code":"var _jsxFileName = \"/Users/Dodo/Desktop/StopWatch/frontend/src/componets/Stopwatch.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport TaskTable from \"./TaskTable\";\n\nfunction Stopwatch() {\n  // set initial state for stopwatch\n  const user = JSON.parse(localStorage.getItem(\"loggedinUser\"));\n  const [userData, setUserData] = useState({}); // console.log(\"user\", user);\n\n  const [timer, setTimer] = useState({\n    hours: 0,\n    minutes: 0,\n    seconds: 0\n  }); // set the intervalid to null\n\n  const [intervalId, setIntervalId] = useState(null);\n  const [startButton, setStartButton] = useState(\"Start\"); // set input fields to empty\n\n  const [taskInput, setTaskInput] = useState({\n    task: \"\",\n    category: \"\",\n    client: \"\"\n  });\n  const [tasksArray, setTasksArray] = useState([]);\n  const [message, setMessage] = useState({\n    showMessage: false,\n    messageSuccess: false\n  }); // Sets the states based on user inputs\n\n  function handleInput(event) {\n    const value = event.target.value;\n    const fieldName = event.target.name;\n    setTaskInput(prevState => {\n      return { ...prevState,\n        [fieldName]: value\n      };\n    });\n  }\n\n  function watchToggle() {\n    messageClear();\n\n    if (!intervalId) {\n      // start timer\n      setStartButton(\"Pause\");\n      const id = setInterval(() => {\n        setTimer(prevState => {\n          let minutes = prevState.minutes;\n          let seconds = prevState.seconds;\n          let hours = prevState.hours;\n\n          if (seconds === 59) {\n            seconds = 0;\n            minutes++;\n          } else {\n            seconds++;\n          }\n\n          if (minutes === 59) {\n            minutes = 0;\n            hours++;\n          }\n\n          return {\n            seconds,\n            minutes,\n            hours\n          };\n        });\n      }, 1000); //  save interval id\n\n      setIntervalId(id);\n    } else {\n      // pause timer\n      clearInterval(intervalId);\n      setStartButton(\"Resume\"); //   remove internal id from stae\n\n      setIntervalId(null);\n    }\n  }\n\n  function watchDone() {\n    clearInterval(intervalId);\n    setIntervalId(null);\n    setStartButton(\"Start\"); // send request to server\n\n    fetch(\"http://localhost:5000/tasks/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\" // body type\n\n      },\n      body: JSON.stringify({\n        userEmail: user,\n        taskTitle: taskInput.task,\n        taskCategory: taskInput.category,\n        clientName: taskInput.client,\n        // duration: timer.seconds * 1000 + timer.minutes * 60000 + timer.hours * 3600000,\n        duration: {\n          seconds: timer.seconds,\n          minutes: timer.minutes,\n          hours: timer.hours\n        }\n      })\n    }).then(function (response) {\n      // run after get response from server\n      console.log(\"res\", response);\n      return response.json(); // wait to body data from server (PROMISE)\n    }).then(function (body) {\n      //   run after all body back from server\n      console.log(body);\n      setMessage({\n        showMessage: true,\n        messageSuccess: body.success\n      });\n    }).then(setTaskInput({\n      task: \"\",\n      category: \"\",\n      client: \"\"\n    })).then(setTimer({\n      hours: 0,\n      minutes: 0,\n      seconds: 0\n    })); // fetch(\"http://localhost:5000/users/updatecategories\", {\n    //    method: \"PATCH\",\n    //    headers: {\n    //       \"Content-Type\": \"application/json\", // body type\n    //    },\n    //    body: JSON.stringify({\n    //       category: taskInput.category,\n    //       userEmail: user,\n    //    }),\n    // })\n    //    .then(function (response) {\n    //       // run after get response from server\n    //       console.log(\"res\", response);\n    //       return response.json(); // wait to body data from server (PROMISE)\n    //    })\n    //    .then(function (body) {\n    //       //   run after all body back from server\n    //       console.log(body);\n    //    });\n  }\n\n  function watchReset() {\n    clearInterval(intervalId);\n    setIntervalId(null);\n    setStartButton(\"Start\");\n    setTimer({\n      hours: 0,\n      minutes: 0,\n      seconds: 0\n    });\n    setTaskInput({\n      task: \"\",\n      category: \"\",\n      client: \"\"\n    });\n  }\n\n  function messageClear() {\n    setMessage({\n      showMessage: false,\n      messageSuccess: false\n    });\n  } // run code after every render\n\n\n  useEffect(() => {\n    function getUserTasks() {\n      fetch(\"http://localhost:5000/tasks/\" + user).then(response => response.json()).then(data => setTasksArray(data));\n    }\n\n    getUserTasks();\n  }, [tasksArray]);\n  useEffect(() => {\n    function getUser() {\n      fetch(\"http://localhost:5000/users/getfname/\" + user).then(response => response.json()).then(data => {\n        setUserData(data);\n        console.log(\"getUser \", data);\n      });\n    }\n\n    getUser();\n  }, []); // console.log(\"tasksArray\", tasksArray);\n\n  if (!user) {\n    // if no user in local storage redirect to login\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 14\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"watch-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"welcome\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }, \"Hi \", userData.fname, \", get That work done!\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 13\n    }\n  }, \"Enter a new task and hit that \\\"Start\\\" button, you can always pause and resume, and when your finished with your task hit \\\"Done\\\".\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"digits-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"digits\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 13\n    }\n  }, (\"0\" + timer.hours.toString()).slice(-2), \":\", (\"0\" + timer.minutes.toString()).slice(-2), \":\", (\"0\" + timer.seconds.toString()).slice(-2))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"button-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"control-btn start-button\",\n    disabled: !taskInput.task || !taskInput.category || !taskInput.client,\n    onClick: watchToggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 13\n    }\n  }, startButton), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"control-btn done-button\",\n    disabled: !taskInput.task || !taskInput.category || !taskInput.client || timer.seconds === 0 && timer.minutes === 0 && timer.hours === 0,\n    onClick: watchDone,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 13\n    }\n  }, \"Done\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: watchReset,\n    className: \"control-btn reset-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 13\n    }\n  }, \"Discard\")), message.showMessage && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `alert-${message.messageSuccess ? \"success\" : \"failure\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 16\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"closebtn\",\n    onClick: messageClear,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 19\n    }\n  }, \"\\xD7\"), message.messageSuccess ? \"Success!\" : \" Failure!\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputs-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleInput,\n    name: \"task\",\n    placeholder: \"Enter task\",\n    value: taskInput.task,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleInput,\n    type: \"text\",\n    name: \"category\",\n    list: \"categoryList\",\n    placeholder: \"Category\",\n    value: taskInput.category,\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"datalist\", {\n    id: \"categoryList\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 13\n    }\n  }, userData.userCategories.map(category => {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      value: category,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 26\n      }\n    });\n  }), console.log(\"userData\", userData)), /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleInput,\n    name: \"client\",\n    placeholder: \"Enter Client\",\n    value: taskInput.client,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(TaskTable, {\n    tasks: tasksArray,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 10\n    }\n  }));\n}\n\nexport default Stopwatch;","map":{"version":3,"sources":["/Users/Dodo/Desktop/StopWatch/frontend/src/componets/Stopwatch.jsx"],"names":["React","useState","useEffect","Redirect","TaskTable","Stopwatch","user","JSON","parse","localStorage","getItem","userData","setUserData","timer","setTimer","hours","minutes","seconds","intervalId","setIntervalId","startButton","setStartButton","taskInput","setTaskInput","task","category","client","tasksArray","setTasksArray","message","setMessage","showMessage","messageSuccess","handleInput","event","value","target","fieldName","name","prevState","watchToggle","messageClear","id","setInterval","clearInterval","watchDone","fetch","method","headers","body","stringify","userEmail","taskTitle","taskCategory","clientName","duration","then","response","console","log","json","success","watchReset","getUserTasks","data","getUser","fname","toString","slice","userCategories","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\n\nimport { Redirect } from \"react-router-dom\";\nimport TaskTable from \"./TaskTable\";\n\nfunction Stopwatch() {\n   // set initial state for stopwatch\n   const user = JSON.parse(localStorage.getItem(\"loggedinUser\"));\n   const [userData, setUserData] = useState({});\n   // console.log(\"user\", user);\n\n   const [timer, setTimer] = useState({\n      hours: 0,\n      minutes: 0,\n      seconds: 0,\n   });\n   // set the intervalid to null\n   const [intervalId, setIntervalId] = useState(null);\n\n   const [startButton, setStartButton] = useState(\"Start\");\n   // set input fields to empty\n   const [taskInput, setTaskInput] = useState({\n      task: \"\",\n      category: \"\",\n      client: \"\",\n   });\n\n   const [tasksArray, setTasksArray] = useState([]);\n\n   const [message, setMessage] = useState({\n      showMessage: false,\n      messageSuccess: false,\n   });\n\n   // Sets the states based on user inputs\n   function handleInput(event) {\n      const value = event.target.value;\n      const fieldName = event.target.name;\n      setTaskInput((prevState) => {\n         return {\n            ...prevState,\n            [fieldName]: value,\n         };\n      });\n   }\n\n   function watchToggle() {\n      messageClear();\n      if (!intervalId) {\n         // start timer\n         setStartButton(\"Pause\");\n         const id = setInterval(() => {\n            setTimer((prevState) => {\n               let minutes = prevState.minutes;\n               let seconds = prevState.seconds;\n               let hours = prevState.hours;\n\n               if (seconds === 59) {\n                  seconds = 0;\n                  minutes++;\n               } else {\n                  seconds++;\n               }\n\n               if (minutes === 59) {\n                  minutes = 0;\n                  hours++;\n               }\n               return { seconds, minutes, hours };\n            });\n         }, 1000);\n\n         //  save interval id\n         setIntervalId(id);\n      } else {\n         // pause timer\n         clearInterval(intervalId);\n         setStartButton(\"Resume\");\n         //   remove internal id from stae\n         setIntervalId(null);\n      }\n   }\n\n   function watchDone() {\n      clearInterval(intervalId);\n      setIntervalId(null);\n      setStartButton(\"Start\");\n      // send request to server\n      fetch(\"http://localhost:5000/tasks/\", {\n         method: \"POST\",\n         headers: {\n            \"Content-Type\": \"application/json\", // body type\n         },\n         body: JSON.stringify({\n            userEmail: user,\n            taskTitle: taskInput.task,\n            taskCategory: taskInput.category,\n            clientName: taskInput.client,\n            // duration: timer.seconds * 1000 + timer.minutes * 60000 + timer.hours * 3600000,\n            duration: {\n               seconds: timer.seconds,\n               minutes: timer.minutes,\n               hours: timer.hours,\n            },\n         }),\n      })\n         .then(function (response) {\n            // run after get response from server\n            console.log(\"res\", response);\n            return response.json(); // wait to body data from server (PROMISE)\n         })\n         .then(function (body) {\n            //   run after all body back from server\n            console.log(body);\n\n            setMessage({\n               showMessage: true,\n               messageSuccess: body.success,\n            });\n         })\n         .then(\n            setTaskInput({\n               task: \"\",\n               category: \"\",\n               client: \"\",\n            }),\n         )\n         .then(\n            setTimer({\n               hours: 0,\n               minutes: 0,\n               seconds: 0,\n            }),\n         );\n\n      // fetch(\"http://localhost:5000/users/updatecategories\", {\n      //    method: \"PATCH\",\n      //    headers: {\n      //       \"Content-Type\": \"application/json\", // body type\n      //    },\n      //    body: JSON.stringify({\n      //       category: taskInput.category,\n      //       userEmail: user,\n      //    }),\n      // })\n      //    .then(function (response) {\n      //       // run after get response from server\n      //       console.log(\"res\", response);\n      //       return response.json(); // wait to body data from server (PROMISE)\n      //    })\n      //    .then(function (body) {\n      //       //   run after all body back from server\n      //       console.log(body);\n      //    });\n   }\n\n   function watchReset() {\n      clearInterval(intervalId);\n      setIntervalId(null);\n      setStartButton(\"Start\");\n      setTimer({\n         hours: 0,\n         minutes: 0,\n         seconds: 0,\n      });\n      setTaskInput({\n         task: \"\",\n         category: \"\",\n         client: \"\",\n      });\n   }\n\n   function messageClear() {\n      setMessage({\n         showMessage: false,\n         messageSuccess: false,\n      });\n   }\n\n   // run code after every render\n   useEffect(() => {\n      function getUserTasks() {\n         fetch(\"http://localhost:5000/tasks/\" + user)\n            .then((response) => response.json())\n            .then((data) => setTasksArray(data));\n      }\n\n      getUserTasks();\n   }, [tasksArray]);\n\n   useEffect(() => {\n      function getUser() {\n         fetch(\"http://localhost:5000/users/getfname/\" + user)\n            .then((response) => response.json())\n            .then((data) => {\n               setUserData(data);\n               console.log(\"getUser \", data);\n            });\n      }\n\n      getUser();\n   }, []);\n\n   // console.log(\"tasksArray\", tasksArray);\n\n   if (!user) {\n      // if no user in local storage redirect to login\n      return <Redirect to='/login' />;\n   }\n\n   return (\n      <div>\n         <header className='watch-header'>\n            <h1 className='welcome'>Hi {userData.fname}, get That work done!</h1>\n            <p className='instructions'>\n               Enter a new task and hit that \"Start\" button, you can always pause and resume, and when your finished with your\n               task hit \"Done\".\n            </p>\n         </header>\n\n         <div className='digits-container'>\n            <div className='digits'>\n               {(\"0\" + timer.hours.toString()).slice(-2)}:{(\"0\" + timer.minutes.toString()).slice(-2)}:\n               {(\"0\" + timer.seconds.toString()).slice(-2)}\n            </div>\n         </div>\n         <div className='button-container'>\n            <button\n               className='control-btn start-button'\n               disabled={!taskInput.task || !taskInput.category || !taskInput.client}\n               onClick={watchToggle}>\n               {startButton}\n            </button>\n            <button\n               className='control-btn done-button'\n               disabled={\n                  !taskInput.task ||\n                  !taskInput.category ||\n                  !taskInput.client ||\n                  (timer.seconds === 0 && timer.minutes === 0 && timer.hours === 0)\n               }\n               onClick={watchDone}>\n               Done\n            </button>\n            <button onClick={watchReset} className='control-btn reset-button'>\n               Discard\n            </button>\n         </div>\n         {message.showMessage && (\n            <div className='alert-container'>\n               <div className={`alert-${message.messageSuccess ? \"success\" : \"failure\"}`}>\n                  <span className='closebtn' onClick={messageClear}>\n                     &times;\n                  </span>\n                  {message.messageSuccess ? \"Success!\" : \" Failure!\"}\n               </div>\n            </div>\n         )}\n         <div className='inputs-container'>\n            <input onChange={handleInput} name='task' placeholder='Enter task' value={taskInput.task}></input>\n            <input\n               onChange={handleInput}\n               type='text'\n               name='category'\n               list='categoryList'\n               placeholder='Category'\n               value={taskInput.category}\n               autoComplete='off'\n            />\n            <datalist id='categoryList'>\n               {userData.userCategories.map((category) => {\n                  return <option value={category} />;\n               })}\n               {console.log(\"userData\", userData)}\n            </datalist>\n            <input onChange={handleInput} name='client' placeholder='Enter Client' value={taskInput.client}></input>\n         </div>\n         <TaskTable tasks={tasksArray} />\n      </div>\n   );\n}\n\nexport default Stopwatch;\n"]},"metadata":{},"sourceType":"module"}